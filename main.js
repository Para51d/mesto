(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===t(i)?i:String(i)),o)}var i}var n=function(){function t(e,n,r,o,i,u){var a=e.likes,c=e.name,l=e.link,s=e._id,f=e.owner;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=c,this._link=l,this._cardId=s,this._likes=a,this._userId=u,this._templateElement=n,this._handleCardClick=r,this._handleLikeClick=o,this._handleDeleteClick=i,this._isOwner=f._id===u,this._isLiked=this._checkUserLike()}var n,r;return n=t,r=[{key:"_getTemplate",value:function(){return this._templateElement.querySelector(".card").cloneNode(!0)}},{key:"_handleLikeCard",value:function(){this._handleLikeClick(this._cardId,this._isLiked,this)}},{key:"_checkUserLike",value:function(){var t=this;return this._likes.some((function(e){return e._id===t._userId}))}},{key:"_toggleLikeButtonState",value:function(t){t?this._likeButton.classList.add("card__button-like_active"):this._likeButton.classList.remove("card__button-like_active")}},{key:"checkLike",value:function(t){t&&(this._likes=t,this._isLiked=this._checkUserLike()),this._likeCounter.textContent=this._likes.length,this._toggleLikeButtonState(this._isLiked)}},{key:"blockLikeButton",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._likeButton.disabled=t}},{key:"handleDeleteCard",value:function(){this._element.remove(),this._element=null}},{key:"_setEventListeners",value:function(){var t=this;this._imageElement.addEventListener("click",(function(){t._handleCardClick(t._imageElement)})),this._likeButton.addEventListener("click",(function(){t._handleLikeCard()})),this._isOwner&&this._buttonDelete.addEventListener("click",(function(){t._handleDeleteClick(t._cardId,t)}))}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._imageElement=this._element.querySelector(".card__image"),this._imageElement.src=this._image,this._imageElement.alt=this._title,this._element.querySelector(".card__title").textContent=this._title,this._likeButton=this._element.querySelector(".card__button-like"),this._likeCounter=this._element.querySelector(".card__like-counter"),this._buttonDelete=this._element.querySelector(".card__button-removal"),this._likeCounter.textContent="".concat(this._likes.length),this._isOwner||this._buttonDelete.remove(),this.checkLike(),this._setEventListeners(),this._element}}],r&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}var i=function(){function t(e){var n=e.baseUrl,r=e.headers;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=n,this._headers=r}var e,n;return e=t,(n=[{key:"_getResponse",value:function(t){return t.ok?t.json():Promise.reject(t.status)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then(this._getResponse)}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then(this._getResponse)}},{key:"editUserInfo",value:function(t){var e=t.name,n=t.about;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:n})}).then(this._getResponse)}},{key:"addNewCard",value:function(t){var e=t.name,n=t.link;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:n})}).then(this._getResponse)}},{key:"changeUserAvatar",value:function(t){var e=t.avatar;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._getResponse)}},{key:"deleteCard",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t),{method:"DELETE",headers:this._headers}).then(this._getResponse)}},{key:"_addLike",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"PUT",headers:this._headers}).then(this._getResponse)}},{key:"_removeLike",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:this._headers}).then(this._getResponse)}},{key:"handleLike",value:function(t,e){return e?this._removeLike(t):this._addLike(t)}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),u={formSelector:".form",submitSelector:".form__save",inputSelector:".form__input",inputInvalidClass:"form__input_invalid",inputSectionSelector:".form__section",inputErrorClass:"form__input-error_active",inputErrorSelector:".form__input-error",disabledButtonClass:"form__save_inactive"},a=document.querySelector(".profile__edit-button"),c=document.querySelector(".profile__add-button"),l=document.querySelector(".profile__change-avatar"),s=document.querySelector(".form__avatar"),f=document.querySelector(".form__profile"),p=document.querySelector(".form__add-card"),y=document.querySelector("#item").content;function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v(r.key),r)}}function m(t,e,n){return(e=v(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t){var e=function(t,e){if("object"!==h(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===h(e)?e:String(e)}y.querySelector(".card__button-removal");var d=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),m(this,"resetValidation",(function(){r._toggleButtonState(),r._inputList.forEach((function(t){t.classList.remove(r._inputInvalidClass),t.classList.remove(r._inputErrorClass),t.nextElementSibling.textContent=""}))})),m(this,"enableValidation",(function(){r._setEventListeners()})),this._inputSelector=e.inputSelector,this._submitSelector=e.submitSelector,this._disabledButtonClass=e.disabledButtonClass,this._inputInvalidClass=e.inputInvalidClass,this._inputErrorClass=e.inputErrorClass,this._inputErrorSelector=e.inputErrorSelector,this._inputSectionSelector=e.inputSectionSelector,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(e.inputSelector))}var e,n;return e=t,(n=[{key:"_showInputError",value:function(){var t=this._inputElement.closest(this._inputSectionSelector).querySelector(this._inputErrorSelector);this._inputElement.classList.add(this._inputInvalidClass),t.classList.add(this._inputErrorClass),t.textContent=this._inputElement.validationMessage}},{key:"_hideInputError",value:function(){var t=this._inputElement.closest(this._inputSectionSelector).querySelector(this._inputErrorSelector);this._inputElement.classList.remove(this._inputInvalidClass),t.classList.remove(this._inputErrorClass),t.textContent=""}},{key:"_isValid",value:function(t){this._inputElement.validity.valid?this._hideInputError(t):this._showInputError(t)}},{key:"_toggleButtonState",value:function(){var t=this._formElement.checkValidity();this._buttonElement.disabled=!t,this._buttonElement.classList.toggle(this._disabledButtonClass,!t)}},{key:"_setEventListeners",value:function(){var t=this;this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._inputElement=e,t._isValid(),t._toggleButtonState()}))})),this._buttonElement=this._formElement.querySelector(this._submitSelector)}}])&&b(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==_(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===_(o)?o:String(o)),r)}var o}var g=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._renderer=e,this._container=document.querySelector(n)}var e,n;return e=t,n=[{key:"addItem",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._container.prepend(t):this._container.append(t)}},{key:"renderItems",value:function(t){var e=this;t.forEach((function(t){e._renderer(t)}))}}],n&&S(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,E(r.key),r)}}function E(t){var e=function(t,e){if("object"!==k(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===k(e)?e:String(e)}var O=function(){function t(e){var n,r,o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=function(t){"Escape"===t.key&&i.close()},(r=E(r="_handleEscClose"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popup=document.querySelector(e),this._keyHandler=this._handleEscClose.bind(this)}var e,n;return e=t,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._keyHandler)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._keyHandler)}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("click",(function(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__button-close"))&&t.close()}))}}])&&w(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==j(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===j(o)?o:String(o)),r)}var o}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=I(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},C.apply(this,arguments)}function P(t,e){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},P(t,e)}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}var B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=I(r);if(o){var n=I(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._form=n._popup.querySelector(".form"),n._inputList=n._form.querySelectorAll(".form__input"),n._handleFormSubmit=e,n._submitButton=n._form.querySelector(".form__save"),n}return e=u,n=[{key:"_getInputValues",value:function(){var t=this;return this._formInputValues={},this._inputList.forEach((function(e){t._formInputValues[e.name]=e.value})),this._formInputValues}},{key:"setInputValues",value:function(t){this._inputList.forEach((function(e){e.value=t[e.name]}))}},{key:"close",value:function(){C(I(u.prototype),"close",this).call(this),this._form.reset()}},{key:"setEventListeners",value:function(){var t=this;C(I(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(e){e.preventDefault(),t._handleFormSubmit(t._getInputValues()),t.close()}))}},{key:"blockButton",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._submitButton.disabled=e,this._submitButton.textContent=t}}],n&&L(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(O);function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==R(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===R(o)?o:String(o)),r)}var o}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},q.apply(this,arguments)}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}var V=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=x(r);if(o){var n=x(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===R(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._image=e._popup.querySelector(".popup__image"),e._imageFigcaption=e._popup.querySelector(".popup__figcaption"),e}return e=u,(n=[{key:"open",value:function(t,e){q(x(u.prototype),"open",this).call(this),this._image.src=e,this._image.alt=t,this._imageFigcaption.textContent=t}}])&&T(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(O);function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==D(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===D(o)?o:String(o)),r)}var o}function N(){return N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=J(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},N.apply(this,arguments)}function H(t,e){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},H(t,e)}function F(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function J(t){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},J(t)}var G,M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=J(r);if(o){var n=J(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===D(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return F(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._form=e._popup.querySelector(".form"),e._submitButton=e._form.querySelector(".form__save"),e._submitCallback=e._submitCallback.bind(F(e)),e}return e=u,n=[{key:"handleSubmit",value:function(t){this._handleSubmit=t}},{key:"_submitCallback",value:function(t){t.preventDefault(),this._handleSubmit()}},{key:"setEventListeners",value:function(){N(J(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",this._submitCallback)}},{key:"blockButton",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._submitButton.disabled=e,this._submitButton.textContent=t}}],n&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(O);function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==z(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===z(o)?o:String(o)),r)}var o}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Q=new(function(){function t(e){var n=e.nameSelector,r=e.aboutSelector,o=e.avatarSelector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=document.querySelector(n),this._about=document.querySelector(r),this._avatar=document.querySelector(o)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,about:this._about.textContent}}},{key:"setUserInfo",value:function(t){var e=t.name,n=t.about;this._name.textContent=e,this._about.textContent=n}},{key:"setUserAvatar",value:function(t){var e=t.avatar;this._avatar.src=e}}])&&$(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}())({nameSelector:".profile__username",aboutSelector:".profile__text",avatarSelector:".profile__avatar"}),W=new i({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-65",headers:{authorization:"bc0e8a37-d4e2-49ec-b42f-132165b9c35f","Content-Type":"application/json"}}),X=function(t,e,n){n.blockLikeButton(),W.handleLike(t,e).then((function(t){n.checkLike(t.likes)})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){return n.blockLikeButton(!1)}))},Y=function(t,e){nt.handleSubmit((function(){return function(t,e){nt.blockButton("Удаление..."),W.deleteCard(t).then((function(){e.handleDeleteCard(),nt.close()})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){return nt.blockButton("Да",!1)}))}(t,e)})),nt.open()},Z=function(t){rt.open(t)},tt=function(t,e){var r=new n(t,y,Z,X,Y,G).generateCard();et.addItem(r,e)},et=new g(tt,".places"),nt=new M(".popup_type_delete-card");nt.setEventListeners();var rt=new V(".popup_type_image");rt.setEventListeners();var ot=new B(".popup_type_add-place",(function(t){ot.blockButton("Создание..."),W.addNewCard(t).then((function(t){tt(t,!0),ot.close()})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){return ot.blockButton("Создать",!1)}))}));ot.setEventListeners();var it=new B(".popup_type_profile",(function(t){it.blockButton("Сохранение..."),W.editUserInfo(t).then((function(t){Q.setUserInfo(t),it.close()})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){return it.blockButton("Сохранить",!1)}))}));it.setEventListeners();var ut=new B(".popup_type_change-avatar",(function(t){ut.blockButton("Сохранение..."),W.changeUserAvatar(t).then((function(t){Q.setUserAvatar(t),ut.close()})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){return ut.blockButton("Сохранить",!1)}))}));ut.setEventListeners();var at=new d(u,f);at.enableValidation();var ct=new d(u,p);ct.enableValidation();var lt=new d(u,s);lt.enableValidation(),Promise.all([W.getUserInfo(),W.getInitialCards()]).then((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw o}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];G=o._id,Q.setUserInfo(o),Q.setUserAvatar(o),et.renderItems(i)})).catch((function(t){return console.log("Ошибка: ".concat(t))})),l.addEventListener("click",(function(){lt.resetValidation(),ut.open()})),a.addEventListener("click",(function(){var t=Q.getUserInfo(),e=t.name,n=t.about;it.setInputValues({name:e,about:n}),at.resetValidation(),it.open()})),c.addEventListener("click",(function(){ct.resetValidation(),ot.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUIsSSxJQUFBeUUsRyxFQUFBLEUsNENBQUF6RSxJLG8yQkFBckJ3TyxFQUFRL0osRUFBQSxHQUFFZ0ssRUFBS2hLLEVBQUEsR0FDbkJwRSxFQUFTbU8sRUFBUy9OLElBQ2xCOEssRUFBU3NDLFlBQVlXLEdBQ3JCakQsRUFBU3lDLGNBQWNRLEdBQ3ZCbEIsR0FBU29CLFlBQVlELEVBQ3pCLElBQ0N0QyxPQUFNLFNBQUFDLEdBQUssT0FBSUMsUUFBUUMsSUFBSSxXQUFEL0ksT0FBWTZJLEdBQVEsSUFFbkRwRyxFQUFtQmpELGlCQUFpQixTQUFTLFdBQ3pDcUwsR0FBdUJPLGtCQUN2QmIsR0FBa0JoQixNQUN0QixJQUVBakgsRUFBa0I5QyxpQkFBaUIsU0FoSVQsV0FDdEIsSUFBQTZMLEVBQXdCckQsRUFBUytDLGNBQXpCL04sRUFBSXFPLEVBQUpyTyxLQUFNbUUsRUFBS2tLLEVBQUxsSyxNQUNkaUosR0FBaUJrQixlQUFlLENBQUV0TyxLQUFBQSxFQUFNbUUsTUFBQUEsSUFDeEN1SixHQUFrQlUsa0JBQ2xCaEIsR0FBaUJiLE1BQ3JCLElBNkhBL0csRUFBc0JoRCxpQkFBaUIsU0FBUyxXQUM1Q29MLEdBQW1CUSxrQkFDbkJsQixHQUFpQlgsTUFDckIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb25zdGFudHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoeyBsaWtlcywgbmFtZSwgbGluaywgX2lkLCBvd25lciB9LCB0ZW1wbGF0ZUVsZW1lbnQsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlTGlrZUNsaWNrLCBoYW5kbGVEZWxldGVDbGljaywgdXNlcklkKSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICAgICAgdGhpcy5fY2FyZElkID0gX2lkO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuX3RlbXBsYXRlRWxlbWVudCA9IHRlbXBsYXRlRWxlbWVudDtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faXNPd25lciA9IG93bmVyLl9pZCA9PT0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuX2lzTGlrZWQgPSB0aGlzLl9jaGVja1VzZXJMaWtlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90ZW1wbGF0ZUVsZW1lbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJylcclxuICAgICAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlTGlrZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMuX2NhcmRJZCwgdGhpcy5faXNMaWtlZCwgdGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrVXNlckxpa2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUob3duZXIgPT4gb3duZXIuX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gICAgfVxyXG5cclxuICAgIF90b2dnbGVMaWtlQnV0dG9uU3RhdGUoaXNMaWtlZCkge1xyXG4gICAgICAgIGlmIChpc0xpa2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2J1dHRvbi1saWtlX2FjdGl2ZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19idXR0b24tbGlrZV9hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrTGlrZShsaWtlcykge1xyXG4gICAgICAgIGlmIChsaWtlcykge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG4gICAgICAgICAgICB0aGlzLl9pc0xpa2VkID0gdGhpcy5fY2hlY2tVc2VyTGlrZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgICAgICB0aGlzLl90b2dnbGVMaWtlQnV0dG9uU3RhdGUodGhpcy5faXNMaWtlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgYmxvY2tMaWtlQnV0dG9uKGlzQmxvY2tlZCA9IHRydWUpIHtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmRpc2FibGVkID0gaXNCbG9ja2VkO1xyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5faW1hZ2VFbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLl9pc093bmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2NhcmRJZCwgdGhpcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgICAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICAgICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2ltYWdlO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl90aXRsZTtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2J1dHRvbi1saWtlXCIpO1xyXG4gICAgICAgIHRoaXMuX2xpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRlclwiKTtcclxuICAgICAgICB0aGlzLl9idXR0b25EZWxldGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uLXJlbW92YWxcIik7XHJcbiAgICAgICAgdGhpcy5fbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSBgJHt0aGlzLl9saWtlcy5sZW5ndGh9YDtcclxuICAgICAgICBpZiAoIXRoaXMuX2lzT3duZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRGVsZXRlLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoZWNrTGlrZSgpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBDYXJkIH07IiwiY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFJlc3BvbnNlKHJlcykge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KS50aGVuKHRoaXMuX2dldFJlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSkudGhlbih0aGlzLl9nZXRSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICBhYm91dDogYWJvdXRcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KS50aGVuKHRoaXMuX2dldFJlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgbGluazogbGlua1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZVVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6IGF2YXRhcixcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KS50aGVuKHRoaXMuX2dldFJlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9hZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZW1vdmVMaWtlKGNhcmRJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZUxpa2UoY2FyZElkLCBpc0xpa2VkKSB7XHJcbiAgICAgICAgaWYgKGlzTGlrZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbW92ZUxpa2UoY2FyZElkKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWRkTGlrZShjYXJkSWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHsgQXBpIH07ICIsImV4cG9ydCBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgICBzdWJtaXRTZWxlY3RvcjogXCIuZm9ybV9fc2F2ZVwiLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcclxuICAgIGlucHV0SW52YWxpZENsYXNzOiBcImZvcm1fX2lucHV0X2ludmFsaWRcIixcclxuICAgIGlucHV0U2VjdGlvblNlbGVjdG9yOiBcIi5mb3JtX19zZWN0aW9uXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbiAgICBpbnB1dEVycm9yU2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0LWVycm9yXCIsXHJcbiAgICBkaXNhYmxlZEJ1dHRvbkNsYXNzOiBcImZvcm1fX3NhdmVfaW5hY3RpdmVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBidXR0b25FZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBidXR0b25Qcm9maWxlQ2FyZEVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBidXR0b25DaGFuZ2VBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2NoYW5nZS1hdmF0YXJcIik7XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBFZGl0QXZhdGFyID0gXCIucG9wdXBfdHlwZV9jaGFuZ2UtYXZhdGFyXCI7XHJcbmV4cG9ydCBjb25zdCBmb3JtUG9wdXBDaGFuZ2VBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2F2YXRhclwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cFByb2ZpbGVTZWN0aW9uID0gXCIucG9wdXBfdHlwZV9wcm9maWxlXCI7XHJcbmV4cG9ydCBjb25zdCBmb3JtRWRpdFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3Byb2ZpbGVcIik7XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBUeXBlQWRkUGxhY2UgPSBcIi5wb3B1cF90eXBlX2FkZC1wbGFjZVwiO1xyXG5leHBvcnQgY29uc3QgZm9ybVBvcHVwVHlwZUFkZENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2FkZC1jYXJkXCIpO1xyXG5leHBvcnQgY29uc3QgcGxhY2VDYXJkcyA9IFwiLnBsYWNlc1wiO1xyXG5leHBvcnQgY29uc3QgcG9wdXBXaXRoQ29uZmlybWF0aW9uID0gXCIucG9wdXBfdHlwZV9kZWxldGUtY2FyZFwiO1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbmNyZWFzZUltYWdlID0gXCIucG9wdXBfdHlwZV9pbWFnZVwiO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2l0ZW1cIikuY29udGVudDtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvblJlbW92ZUNhcmQgPSBjYXJkVGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b24tcmVtb3ZhbFwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICAgIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTY1JyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiAnYmMwZThhMzctZDRlMi00OWVjLWI0MmYtMTMyMTY1YjljMzVmJyxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZUluZm8gPSB7XHJcbiAgICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3VzZXJuYW1lXCIsXHJcbiAgICBhYm91dFNlbGVjdG9yOiBcIi5wcm9maWxlX190ZXh0XCIsXHJcbiAgICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fYXZhdGFyXCJcclxufTsiLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9wdGlvbnMuaW5wdXRTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9zdWJtaXRTZWxlY3RvciA9IG9wdGlvbnMuc3VibWl0U2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fZGlzYWJsZWRCdXR0b25DbGFzcyA9IG9wdGlvbnMuZGlzYWJsZWRCdXR0b25DbGFzcztcclxuICAgICAgICB0aGlzLl9pbnB1dEludmFsaWRDbGFzcyA9IG9wdGlvbnMuaW5wdXRJbnZhbGlkQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gb3B0aW9ucy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvclNlbGVjdG9yID0gb3B0aW9ucy5pbnB1dEVycm9yU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTZWN0aW9uU2VsZWN0b3IgPSBvcHRpb25zLmlucHV0U2VjdGlvblNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKG9wdGlvbnMuaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0VmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0SW52YWxpZENsYXNzKTtcclxuICAgICAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgICAgICBpbnB1dC5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSAnJztcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IoKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5faW5wdXRFbGVtZW50LmNsb3Nlc3QodGhpcy5faW5wdXRTZWN0aW9uU2VsZWN0b3IpLnF1ZXJ5U2VsZWN0b3IodGhpcy5faW5wdXRFcnJvclNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9pbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEludmFsaWRDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9pbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgX2hpZGVJbnB1dEVycm9yKCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2lucHV0RWxlbWVudC5jbG9zZXN0KHRoaXMuX2lucHV0U2VjdGlvblNlbGVjdG9yKS5xdWVyeVNlbGVjdG9yKHRoaXMuX2lucHV0RXJyb3JTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRJbnZhbGlkQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgX2lzVmFsaWQoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9pbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgaXNGb3JtVmFsaWQgPSB0aGlzLl9mb3JtRWxlbWVudC5jaGVja1ZhbGlkaXR5KCk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9ICFpc0Zvcm1WYWxpZDtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVkQnV0dG9uQ2xhc3MsXHJcbiAgICAgICAgICAgICFpc0Zvcm1WYWxpZFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dEVsZW1lbnQgPSBpbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pc1ZhbGlkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBGb3JtVmFsaWRhdG9yIH07IiwiY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oZWxlbWVudCwgaXNTdGFydCA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKGlzU3RhcnQpIHtcclxuICAgICAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgICAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IHsgU2VjdGlvbiB9OyIsImNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fa2V5SGFuZGxlciA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2tleUhhbmRsZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fa2V5SGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikgfHwgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fYnV0dG9uLWNsb3NlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHsgUG9wdXAgfTsiLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG5cclxuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc2F2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUlucHV0VmFsdWVzID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1JbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9mb3JtSW5wdXRWYWx1ZXM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBibG9ja0J1dHRvbihidXR0b25UZXh0LCBpc0Jsb2NrZWQgPSB0cnVlKSB7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gaXNCbG9ja2VkO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IFBvcHVwV2l0aEZvcm0gfTsiLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuXHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuICAgICAgICB0aGlzLl9pbWFnZUZpZ2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19maWdjYXB0aW9uXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5faW1hZ2VGaWdjYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCB7IFBvcHVwV2l0aEltYWdlIH07IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3NhdmVcIik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0Q2FsbGJhY2sgPSB0aGlzLl9zdWJtaXRDYWxsYmFjay5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZVN1Ym1pdChhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBhY3Rpb247XHJcbiAgICB9XHJcblxyXG4gICAgX3N1Ym1pdENhbGxiYWNrKGV2dCkge1xyXG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9zdWJtaXRDYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgYmxvY2tCdXR0b24oYnV0dG9uVGV4dCwgaXNCbG9ja2VkID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGlzQmxvY2tlZDtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBidXR0b25UZXh0O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBQb3B1cFdpdGhDb25maXJtYXRpb24gfTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IHsgQXBpIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7IG9wdGlvbnMsIHNldHRpbmdzLCBwcm9maWxlSW5mbyB9IGZyb20gXCIuLi9jb25zdGFudHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoQ29uZmlybWF0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgICBwb3B1cFdpdGhDb25maXJtYXRpb24sXHJcbiAgICBidXR0b25FZGl0UHJvZmlsZSxcclxuICAgIHBvcHVwUHJvZmlsZVNlY3Rpb24sXHJcbiAgICBwb3B1cEVkaXRBdmF0YXIsXHJcbiAgICBwb3B1cEluY3JlYXNlSW1hZ2UsXHJcbiAgICBidXR0b25Qcm9maWxlQ2FyZEVkaXQsXHJcbiAgICBidXR0b25DaGFuZ2VBdmF0YXIsXHJcbiAgICBmb3JtUG9wdXBDaGFuZ2VBdmF0YXIsXHJcbiAgICBmb3JtRWRpdFByb2ZpbGUsXHJcbiAgICBwb3B1cFR5cGVBZGRQbGFjZSxcclxuICAgIGZvcm1Qb3B1cFR5cGVBZGRDYXJkLFxyXG4gICAgcGxhY2VDYXJkcyxcclxuICAgIGNhcmRUZW1wbGF0ZVxyXG59IGZyb20gXCIuLi9jb25zdGFudHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5cclxubGV0IHVzZXJJZDtcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVJbmZvKTtcclxuY29uc3QgYXBpID0gbmV3IEFwaShzZXR0aW5ncyk7XHJcblxyXG4vLy8vLy8v0L7RgtC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0LAg0LTQu9GPINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8g0L/RgNC+0YTQuNC70Y9cclxuY29uc3QgaGFuZGxlRWRpdFByb2ZpbGUgPSAoKSA9PiB7XHJcbiAgICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gICAgcG9wdXBFZGl0UHJvZmlsZS5zZXRJbnB1dFZhbHVlcyh7IG5hbWUsIGFib3V0IH0pO1xyXG4gICAgcHJvZmlsZVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICBwb3B1cEVkaXRQcm9maWxlLm9wZW4oKTtcclxufTtcclxuXHJcbi8v0LfQsNC/0YDQvtGBINC90LAg0LTQvtCx0LDQstC70LXQvdC40LUg0L3QvtCy0L7QuSDQutCw0YDRgtC+0YfQutC4XHJcbmNvbnN0IGhhbmRsZUFkZENhcmQgPSAoZGF0YSkgPT4ge1xyXG4gICAgcG9wdXBUeXBlQWRkQ2FyZC5ibG9ja0J1dHRvbign0KHQvtC30LTQsNC90LjQtS4uLicpO1xyXG4gICAgYXBpLmFkZE5ld0NhcmQoZGF0YSlcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICByZW5kZXJDYXJkKHJlcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHBvcHVwVHlwZUFkZENhcmQuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycm9yfWApKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHBvcHVwVHlwZUFkZENhcmQuYmxvY2tCdXR0b24oJ9Ch0L7Qt9C00LDRgtGMJywgZmFsc2UpKTtcclxufTtcclxuXHJcbi8vLy8vLy/Qt9Cw0L/RgNC+0YEg0L3QsCDRgdC+0YXRgNCw0L3QtdC90LjQtSDQuNC30LzQtdC90LXQvdC40Lkg0L/RgNC+0YTQuNC70Y9cclxuY29uc3QgaGFuZGxlU2F2ZVByb2ZpbGUgPSAoZGF0YSkgPT4ge1xyXG4gICAgcG9wdXBFZGl0UHJvZmlsZS5ibG9ja0J1dHRvbign0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nKTtcclxuICAgIGFwaS5lZGl0VXNlckluZm8oZGF0YSlcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgICAgICAgICBwb3B1cEVkaXRQcm9maWxlLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJvcn1gKSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiBwb3B1cEVkaXRQcm9maWxlLmJsb2NrQnV0dG9uKCfQodC+0YXRgNCw0L3QuNGC0YwnLCBmYWxzZSkpO1xyXG59O1xyXG5cclxuLy8vLy8vLy/Qt9Cw0L/RgNC+0YEg0L3QsCDRgdC+0YXRgNCw0L3QtdC90LjQtSDQuNC30LzQtdC90LXQvdC40Lkg0LDQstCw0YLQsNGA0LBcclxuY29uc3QgaGFuZGxlU2F2ZUF2YXRhciA9IChkYXRhKSA9PiB7XHJcbiAgICBwb3B1cENoYW5nZUF2YXRhci5ibG9ja0J1dHRvbign0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nKTtcclxuICAgIGFwaS5jaGFuZ2VVc2VyQXZhdGFyKGRhdGEpXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMpO1xyXG4gICAgICAgICAgICBwb3B1cENoYW5nZUF2YXRhci5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyb3J9YCkpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gcG9wdXBDaGFuZ2VBdmF0YXIuYmxvY2tCdXR0b24oJ9Ch0L7RhdGA0LDQvdC40YLRjCcsIGZhbHNlKSk7XHJcbn07XHJcblxyXG4vL9C30LDQv9GA0L7RgSDQvdCwINC+0LHRgNCw0LHQvtGC0LrRgyDQu9Cw0LnQutCwINC60LDRgNGC0L7Rh9C60LhcclxuY29uc3QgaGFuZGxlTGlrZUNsaWNrID0gKGNhcmRJZCwgaXNMaWtlZCwgY2FyZCkgPT4ge1xyXG4gICAgY2FyZC5ibG9ja0xpa2VCdXR0b24oKTtcclxuICAgIGFwaS5oYW5kbGVMaWtlKGNhcmRJZCwgaXNMaWtlZClcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLmNoZWNrTGlrZShyZXMubGlrZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyb3J9YCkpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gY2FyZC5ibG9ja0xpa2VCdXR0b24oZmFsc2UpKTtcclxufTtcclxuXHJcbi8v0LfQsNC/0YDQvtGBINC90LAg0YPQtNCw0LvQtdC90LjQtSDQutCw0YDRgtC+0YfQutC4XHJcbmNvbnN0IGRlbGV0ZUNhcmQgPSAoY2FyZElkLCBjYXJkKSA9PiB7XHJcbiAgICBwb3B1cFdpdGhEZWxldGVDb25maXJtYXRpb24uYmxvY2tCdXR0b24oJ9Cj0LTQsNC70LXQvdC40LUuLi4nKTtcclxuICAgIGFwaS5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgICAgICBwb3B1cFdpdGhEZWxldGVDb25maXJtYXRpb24uY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycm9yfWApKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHBvcHVwV2l0aERlbGV0ZUNvbmZpcm1hdGlvbi5ibG9ja0J1dHRvbign0JTQsCcsIGZhbHNlKSk7XHJcbn07XHJcblxyXG4vL9C+0YLQutGA0YvRgtC40LUg0L/QvtC/0LDQv9CwINC00LvRjyDQv9C+0LTRgtCy0LXRgNC20LTQtdC90LjRjyDRg9C00LDQu9C10L3QuNGPINC60LDRgNGC0L7Rh9C60LhcclxuY29uc3QgaGFuZGxlQ2xpY2tEZWxldGVCdXR0b24gPSAoY2FyZElkLCBjYXJkKSA9PiB7XHJcbiAgICBwb3B1cFdpdGhEZWxldGVDb25maXJtYXRpb24uaGFuZGxlU3VibWl0KCgpID0+IGRlbGV0ZUNhcmQoY2FyZElkLCBjYXJkKSk7XHJcbiAgICBwb3B1cFdpdGhEZWxldGVDb25maXJtYXRpb24ub3BlbigpO1xyXG59O1xyXG5cclxuY29uc3QgaGFuZGxlQ2FyZENsaWNrID0gKGltYWdlRWxlbWVudCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihpbWFnZUVsZW1lbnQpO1xyXG59O1xyXG5cclxuLy/QvtGC0YDQuNGB0L7QstC60LAg0Lgg0LTQvtCx0LDQstC70LXQvdC40LUg0L3QvtCy0L7QuSDQutCw0YDRgtC+0YfQutC4XHJcbmNvbnN0IHJlbmRlckNhcmQgPSAoY2FyZERhdGEsIGlzU3RhcnQpID0+IHtcclxuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgY2FyZFRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUxpa2VDbGljaywgaGFuZGxlQ2xpY2tEZWxldGVCdXR0b24sIHVzZXJJZCk7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50LCBpc1N0YXJ0KTtcclxufTtcclxuXHJcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24ocmVuZGVyQ2FyZCwgcGxhY2VDYXJkcyk7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhEZWxldGVDb25maXJtYXRpb24gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKHBvcHVwV2l0aENvbmZpcm1hdGlvbik7XHJcbnBvcHVwV2l0aERlbGV0ZUNvbmZpcm1hdGlvbi5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UocG9wdXBJbmNyZWFzZUltYWdlKTtcclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHBvcHVwVHlwZUFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cFR5cGVBZGRQbGFjZSwgaGFuZGxlQWRkQ2FyZCk7XHJcbnBvcHVwVHlwZUFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHBvcHVwRWRpdFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cFByb2ZpbGVTZWN0aW9uLCBoYW5kbGVTYXZlUHJvZmlsZSk7XHJcbnBvcHVwRWRpdFByb2ZpbGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHBvcHVwQ2hhbmdlQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBFZGl0QXZhdGFyLCBoYW5kbGVTYXZlQXZhdGFyKTtcclxucG9wdXBDaGFuZ2VBdmF0YXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcblxyXG4vLy8vLy8vLy8vLyDQstCw0LvQuNC00LDRhtC40Y8g0YTQvtGA0LwgLy9cclxuY29uc3QgcHJvZmlsZVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihvcHRpb25zLCBmb3JtRWRpdFByb2ZpbGUpO1xyXG5wcm9maWxlVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBmb3JtQ2FyZFZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihvcHRpb25zLCBmb3JtUG9wdXBUeXBlQWRkQ2FyZCk7XHJcbmZvcm1DYXJkVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBhdmF0YXJDaGFuZ2VWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3Iob3B0aW9ucywgZm9ybVBvcHVwQ2hhbmdlQXZhdGFyKTtcclxuYXZhdGFyQ2hhbmdlVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5Qcm9taXNlLmFsbChbXHJcbiAgICBhcGkuZ2V0VXNlckluZm8oKSxcclxuICAgIGFwaS5nZXRJbml0aWFsQ2FyZHMoKVxyXG5dKVxyXG4gICAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICAgICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhKTtcclxuICAgICAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhjYXJkcyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyb3J9YCkpO1xyXG5cclxuYnV0dG9uQ2hhbmdlQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgYXZhdGFyQ2hhbmdlVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgIHBvcHVwQ2hhbmdlQXZhdGFyLm9wZW4oKTtcclxufSk7XHJcblxyXG5idXR0b25FZGl0UHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUVkaXRQcm9maWxlKTtcclxuXHJcbmJ1dHRvblByb2ZpbGVDYXJkRWRpdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGZvcm1DYXJkVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgIHBvcHVwVHlwZUFkZENhcmQub3BlbigpO1xyXG59KTtcclxuIiwiY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGFib3V0U2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LC8v0LjQvNGPINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xyXG4gICAgICAgICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQsLy/QviDQv9C+0LvRjNC30L7QstCw0YLQtdC70LVcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckF2YXRhcih7IGF2YXRhciB9KSB7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHsgVXNlckluZm8gfTsiXSwibmFtZXMiOlsiQ2FyZCIsIl9yZWYiLCJ0ZW1wbGF0ZUVsZW1lbnQiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsInVzZXJJZCIsImxpa2VzIiwibmFtZSIsImxpbmsiLCJfaWQiLCJvd25lciIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRJZCIsIl9saWtlcyIsIl91c2VySWQiLCJfdGVtcGxhdGVFbGVtZW50IiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaXNPd25lciIsIl9pc0xpa2VkIiwiX2NoZWNrVXNlckxpa2UiLCJrZXkiLCJ2YWx1ZSIsInF1ZXJ5U2VsZWN0b3IiLCJjbG9uZU5vZGUiLCJfdGhpcyIsInNvbWUiLCJpc0xpa2VkIiwiX2xpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJfbGlrZUNvdW50ZXIiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsIl90b2dnbGVMaWtlQnV0dG9uU3RhdGUiLCJpc0Jsb2NrZWQiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJkaXNhYmxlZCIsIl9lbGVtZW50IiwiX3RoaXMyIiwiX2ltYWdlRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUNhcmQiLCJfYnV0dG9uRGVsZXRlIiwiX2dldFRlbXBsYXRlIiwic3JjIiwiX2ltYWdlIiwiYWx0IiwiX3RpdGxlIiwiY29uY2F0IiwiY2hlY2tMaWtlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsIl9nZXRSZXNwb25zZSIsIl9yZWYyIiwiYWJvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIl9yZWYzIiwiX3JlZjQiLCJhdmF0YXIiLCJjYXJkSWQiLCJfcmVtb3ZlTGlrZSIsIl9hZGRMaWtlIiwib3B0aW9ucyIsImZvcm1TZWxlY3RvciIsInN1Ym1pdFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsImlucHV0SW52YWxpZENsYXNzIiwiaW5wdXRTZWN0aW9uU2VsZWN0b3IiLCJpbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yU2VsZWN0b3IiLCJkaXNhYmxlZEJ1dHRvbkNsYXNzIiwiYnV0dG9uRWRpdFByb2ZpbGUiLCJkb2N1bWVudCIsImJ1dHRvblByb2ZpbGVDYXJkRWRpdCIsImJ1dHRvbkNoYW5nZUF2YXRhciIsImZvcm1Qb3B1cENoYW5nZUF2YXRhciIsImZvcm1FZGl0UHJvZmlsZSIsImZvcm1Qb3B1cFR5cGVBZGRDYXJkIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsIl9kZWZpbmVQcm9wZXJ0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9pbnB1dExpc3QiLCJmb3JFYWNoIiwiaW5wdXQiLCJfaW5wdXRJbnZhbGlkQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0U2VsZWN0b3IiLCJfZGlzYWJsZWRCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yU2VsZWN0b3IiLCJfaW5wdXRTZWN0aW9uU2VsZWN0b3IiLCJfZm9ybUVsZW1lbnQiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZXJyb3JFbGVtZW50IiwiX2lucHV0RWxlbWVudCIsImNsb3Nlc3QiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImlucHV0RWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpc0Zvcm1WYWxpZCIsImNoZWNrVmFsaWRpdHkiLCJfYnV0dG9uRWxlbWVudCIsInRvZ2dsZSIsIl9pc1ZhbGlkIiwiU2VjdGlvbiIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJhcHBlbmQiLCJpdGVtcyIsIml0ZW0iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJlIiwiY2xvc2UiLCJfcG9wdXAiLCJfa2V5SGFuZGxlciIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiX1BvcHVwIiwiX2luaGVyaXRzIiwiX3N1cGVyIiwiaGFuZGxlRm9ybVN1Ym1pdCIsImNhbGwiLCJfZm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ1dHRvbiIsIl9mb3JtSW5wdXRWYWx1ZXMiLCJkYXRhIiwiX2dldCIsIl9nZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsInJlc2V0IiwiX3RoaXMzIiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJidXR0b25UZXh0IiwiUG9wdXBXaXRoSW1hZ2UiLCJfaW1hZ2VGaWdjYXB0aW9uIiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiX3N1Ym1pdENhbGxiYWNrIiwiX2Fzc2VydFRoaXNJbml0aWFsaXplZCIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJ1c2VySW5mbyIsIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiYWJvdXRTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX2Fib3V0IiwiX2F2YXRhciIsImFwaSIsImF1dGhvcml6YXRpb24iLCJjYXJkIiwiYmxvY2tMaWtlQnV0dG9uIiwiaGFuZGxlTGlrZSIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsImhhbmRsZUNsaWNrRGVsZXRlQnV0dG9uIiwicG9wdXBXaXRoRGVsZXRlQ29uZmlybWF0aW9uIiwiaGFuZGxlU3VibWl0IiwiYmxvY2tCdXR0b24iLCJkZWxldGVDYXJkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIm9wZW4iLCJpbWFnZUVsZW1lbnQiLCJwb3B1cFdpdGhJbWFnZSIsInJlbmRlckNhcmQiLCJjYXJkRGF0YSIsImlzU3RhcnQiLCJjYXJkRWxlbWVudCIsImdlbmVyYXRlQ2FyZCIsImNhcmRMaXN0IiwiYWRkSXRlbSIsInNldEV2ZW50TGlzdGVuZXJzIiwicG9wdXBUeXBlQWRkQ2FyZCIsImFkZE5ld0NhcmQiLCJwb3B1cEVkaXRQcm9maWxlIiwiZWRpdFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJwb3B1cENoYW5nZUF2YXRhciIsImNoYW5nZVVzZXJBdmF0YXIiLCJzZXRVc2VyQXZhdGFyIiwicHJvZmlsZVZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiZm9ybUNhcmRWYWxpZGF0aW9uIiwiYXZhdGFyQ2hhbmdlVmFsaWRhdGlvbiIsImFsbCIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwidXNlckRhdGEiLCJjYXJkcyIsInJlbmRlckl0ZW1zIiwicmVzZXRWYWxpZGF0aW9uIiwiX3VzZXJJbmZvJGdldFVzZXJJbmZvIiwic2V0SW5wdXRWYWx1ZXMiXSwic291cmNlUm9vdCI6IiJ9